import std.stdio;
import mir.ndslice;

import solve;
import rodrigues;
import project;

void main()
{
    float[][] first = [
        [0.45517698, 0.30089578, -0.76442945], [
            0.44899884, 0.16699584, -0.765143
        ], [0., -0.621079, -0.28729478], [-0.44899884, 0.16699584,
            -0.765143], [-0.45517698, 0.30089578, -0.76442945],
        [0., 0.2933326, -0.1375821], [0., 0.1948287, -0.06915811],
        [0., 0.10384402, -0.00915182], [0., 0., 0.],
        [0.08062635, -0.04127607, -0.13416104],
        [0.04643935, -0.05767522, -0.10299063], [0., -0.06875312,
            -0.09054535], [-0.04643935, -0.05767522, -0.10299063],
        [-0.08062635, -0.04127607, -0.13416104]
    ];

    float[][] second = [
        [345.1081967429509, 450.5167804937514],
        [395.20339357285275, 457.91314897416146],
        [619.6844367980957, 632.2746360355387],
        [398.2810057685489, 824.0053564297459],
        [351.37710966382707, 828.0585772265438],
        [362.3642589024135, 635.2831209797077],
        [395.56775628952755, 635.7220956709965],
        [426.0503022632902, 637.5381274015973],
        [453.09470178210546, 637.7065748588512],
        [471.84026766580246, 605.8410493267907],
        [473.9902781834678, 618.3179405070643],
        [477.44048370633806, 635.2573294911199],
        [475.52302602359225, 651.7397503077777],
        [472.4012308877612, 666.7595640778068]
    ];

    float[][] camera = [
        [1280.0, 0.0, 640.0], [0.0, 1280.0, 360.0], [0.0, 0.0, 1.0]
    ];
    auto a = solvePnPIterative(first.sliced.fuse, second.sliced.fuse, camera.sliced.fuse, slice!float(0));
    writeln(a);
}
